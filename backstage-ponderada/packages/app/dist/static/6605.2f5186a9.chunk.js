"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6605],{6605:(ne,I,n)=>{n.r(I),n.d(I,{CatalogGraphPage:()=>Ke});var A=n(29835),p=n(22968),T=n(5124),F=n(11638),C=n(92651),L=n(42899),le=n(4321),N=n(72501),K=n(58837),re=n(65859),oe=n(98984),se=n(15485),e=n(14041),V=n(18690),h=n(6906),P=n(77125),ie=n(95061),ce=n(29365),ue=n(34839),me=n(35963),_e=n(64704),Y=n(69076),z=n(86901),$=n(16249),X=n(44148),Z=n(41260),j=n(6924),Q=n(20577),Ee=n(73466),de=n(73643),ge=n(45810),J=n.n(ge),w=n(5877),pe=n(53373),Be=n.n(pe);const he={curveMonotoneX:"Monotone X",curveStepBefore:"Step Before"},ve=["curveMonotoneX","curveStepBefore"],Ae=({value:a,onChange:r})=>{const t=(0,e.useCallback)(o=>r(o),[r]);return e.createElement(P.A,{pb:1,pt:1},e.createElement(p.l6,{label:"Curve",selected:a,items:ve.map(o=>({label:he[o],value:o})),onChange:t}))},Ce={[h.D.LEFT_RIGHT]:"Left to right",[h.D.RIGHT_LEFT]:"Right to left",[h.D.TOP_BOTTOM]:"Top to bottom",[h.D.BOTTOM_TOP]:"Bottom to top"},De=({value:a,onChange:r})=>{const t=(0,e.useCallback)(o=>r(o),[r]);return e.createElement(P.A,{pb:1,pt:1},e.createElement(p.l6,{label:"Direction",selected:a,items:Object.values(h.D).map(o=>({label:Ce[o],value:o})),onChange:t}))},Me=(0,K.A)({formControl:{width:"100%",maxWidth:300}},{name:"PluginCatalogGraphMaxDepthFilter"}),Pe=({value:a,onChange:r})=>{const t=Me(),o=(0,e.useRef)(r),[i,u]=(0,e.useState)(a);(0,e.useEffect)(()=>{o.current=r},[r]),(0,e.useEffect)(()=>{u(a)},[a]);const m=(0,e.useCallback)(_=>{const d=Number(_.target.value),s=Number.isFinite(d)&&d>0?d:Number.POSITIVE_INFINITY;u(s),o.current(s)},[]),c=(0,e.useCallback)(()=>{u(Number.POSITIVE_INFINITY),o.current(Number.POSITIVE_INFINITY)},[o]);return e.createElement(P.A,{pb:1,pt:1},e.createElement(ie.A,{variant:"outlined",className:t.formControl},e.createElement(N.A,{variant:"button"},"Max Depth"),e.createElement(me.A,{type:"number",placeholder:"\u221E Infinite",value:Number.isFinite(i)?String(i):"",onChange:m,endAdornment:e.createElement(ue.A,{position:"end"},e.createElement(ce.A,{"aria-label":"clear max depth",onClick:c,edge:"end"},e.createElement(_e.A,null))),inputProps:{"aria-label":"maxp"},labelWidth:0})))},Oe=(0,K.A)({formControl:{maxWidth:300}},{name:"PluginCatalogGraphSelectedKindsFilter"}),fe=({value:a,onChange:r})=>{const t=Oe(),o=(0,T.u)(T.l),i=(0,T.u)(C.vp),{error:u,value:m}=(0,Ee.A)(async()=>await i.getEntityFacets({facets:["kind"]}).then(s=>{var E;return((E=s.facets.kind)==null?void 0:E.map(g=>g.value).sort())||[]}));(0,e.useEffect)(()=>{u&&o.post({message:"Failed to load entity kinds",severity:"error"})},[u,o]);const c=(0,e.useMemo)(()=>m&&m.map(s=>s.toLocaleLowerCase("en-US")),[m]),_=(0,e.useCallback)((s,E)=>{r(c&&c.every(g=>E.includes(g))?void 0:E)},[c,r]),d=(0,e.useCallback)(()=>{r(a!=null&&a.length?a:void 0)},[a,r]);return!(m!=null&&m.length)||!(c!=null&&c.length)||u?e.createElement(e.Fragment,null):e.createElement(P.A,{pb:1,pt:1},e.createElement(N.A,{variant:"button"},"Kinds"),e.createElement(Q.Ay,{className:t.formControl,multiple:!0,limitTags:4,disableCloseOnSelect:!0,"aria-label":"Kinds",options:c,value:a!=null?a:c,getOptionLabel:s=>{var E;return(E=m[c.indexOf(s)])!=null?E:s},onChange:_,onBlur:d,renderOption:(s,{selected:E})=>{var g;return e.createElement(z.A,{control:e.createElement(Y.A,{icon:e.createElement(Z.A,{fontSize:"small"}),checkedIcon:e.createElement(X.A,{fontSize:"small"}),checked:E}),label:(g=m[c.indexOf(s)])!=null?g:s})},size:"small",popupIcon:e.createElement(j.A,{"data-testid":"selected-kinds-expand"}),renderInput:s=>e.createElement($.A,{...s,variant:"outlined"})}))},ye=(0,K.A)({formControl:{maxWidth:300}},{name:"PluginCatalogGraphSelectedRelationsFilter"}),Re=({relationPairs:a,value:r,onChange:t})=>{const o=ye(),i=(0,e.useMemo)(()=>a.flat(),[a]),u=(0,e.useCallback)((c,_)=>{t(i.every(d=>_.includes(d))?void 0:_)},[i,t]),m=(0,e.useCallback)(()=>{t(r!=null&&r.length?r:void 0)},[r,t]);return e.createElement(P.A,{pb:1,pt:1},e.createElement(N.A,{variant:"button"},"Relations"),e.createElement(Q.Ay,{className:o.formControl,multiple:!0,limitTags:4,disableCloseOnSelect:!0,"aria-label":"Relations",options:i,value:r!=null?r:i,onChange:u,onBlur:m,renderOption:(c,{selected:_})=>e.createElement(z.A,{control:e.createElement(Y.A,{icon:e.createElement(Z.A,{fontSize:"small"}),checkedIcon:e.createElement(X.A,{fontSize:"small"}),checked:_}),label:c}),size:"small",popupIcon:e.createElement(j.A,{"data-testid":"selected-relations-expand"}),renderInput:c=>e.createElement($.A,{...c,variant:"outlined"})}))},Ie=(0,K.A)({root:{width:"100%",maxWidth:300}},{name:"PluginCatalogGraphSwitchFilter"}),q=({label:a,value:r,onChange:t})=>{const o=Ie(),i=(0,e.useCallback)(u=>{t(u.target.checked)},[t]);return e.createElement(P.A,{pb:1,pt:1},e.createElement(z.A,{control:e.createElement(de.A,{checked:r,onChange:i,name:a,color:"primary"}),label:a,className:o.root}))};function Te({initialState:a={}}){const r=(0,V.zy)(),t=(0,e.useMemo)(()=>J().parse(r.search,{arrayLimit:0,ignoreQueryPrefix:!0})||{},[r.search]),[o,i]=(0,e.useState)(()=>{var l;return(Array.isArray(t.rootEntityRefs)?t.rootEntityRefs:(l=a==null?void 0:a.rootEntityRefs)!=null?l:[]).map(M=>(0,A.KU)(M))}),[u,m]=(0,e.useState)(()=>{var l;return typeof t.maxDepth=="string"?ee(t.maxDepth):(l=a==null?void 0:a.maxDepth)!=null?l:Number.POSITIVE_INFINITY}),[c,_]=(0,e.useState)(()=>Array.isArray(t.selectedRelations)?t.selectedRelations:a==null?void 0:a.selectedRelations),[d,s]=(0,e.useState)(()=>{var l;return(l=Array.isArray(t.selectedKinds)?t.selectedKinds:a==null?void 0:a.selectedKinds)==null?void 0:l.map(M=>M.toLocaleLowerCase("en-US"))}),[E,g]=(0,e.useState)(()=>{var l;return typeof t.unidirectional=="string"?t.unidirectional==="true":(l=a==null?void 0:a.unidirectional)!=null?l:!0}),[B,O]=(0,e.useState)(()=>{var l;return typeof t.mergeRelations=="string"?t.mergeRelations==="true":(l=a==null?void 0:a.mergeRelations)!=null?l:!0}),[U,f]=(0,e.useState)(()=>{var l;return typeof t.direction=="string"?t.direction:(l=a==null?void 0:a.direction)!=null?l:h.D.LEFT_RIGHT}),[H,b]=(0,e.useState)(()=>{var l;return typeof t.curve=="string"?t.curve:(l=a==null?void 0:a.curve)!=null?l:"curveMonotoneX"}),[S,D]=(0,e.useState)(()=>{var l;return typeof t.showFilters=="string"?t.showFilters==="true":(l=a==null?void 0:a.showFilters)!=null?l:!0}),G=(0,e.useCallback)(()=>D(l=>!l),[D]),W=(0,w.A)(r.search);(0,e.useEffect)(()=>{r.search!==W&&(Array.isArray(t.rootEntityRefs)&&i(t.rootEntityRefs.map(l=>(0,A.KU)(l))),typeof t.maxDepth=="string"&&m(ee(t.maxDepth)),Array.isArray(t.selectedKinds)&&s(t.selectedKinds),Array.isArray(t.selectedRelations)&&_(t.selectedRelations),typeof t.unidirectional=="string"&&g(t.unidirectional==="true"),typeof t.mergeRelations=="string"&&O(t.mergeRelations==="true"),typeof t.direction=="string"&&f(t.direction),typeof t.showFilters=="string"&&D(t.showFilters==="true"))},[W,r.search,t,i,m,s,_,g,O,f,D]);const y=(0,w.A)(o.map(l=>(0,A.U2)(l)));return(0,e.useEffect)(()=>{const l=o.map(x=>(0,A.U2)(x)),M=J().stringify({rootEntityRefs:l,maxDepth:isFinite(u)?u:"\u221E",selectedKinds:d,selectedRelations:c,unidirectional:E,mergeRelations:B,direction:U,showFilters:S},{arrayFormat:"brackets",addQueryPrefix:!0}),v=`${window.location.pathname}${M}`;!y||l.length===y.length&&l.every((x,k)=>x===y[k])?window.history.replaceState(null,document.title,v):window.history.pushState(null,document.title,v)},[o,u,d,c,E,B,U,S,y]),{rootEntityNames:o,setRootEntityNames:i,maxDepth:u,setMaxDepth:m,selectedRelations:c,setSelectedRelations:_,selectedKinds:d,setSelectedKinds:s,unidirectional:E,setUnidirectional:g,mergeRelations:B,setMergeRelations:O,direction:U,setDirection:f,curve:H,setCurve:b,showFilters:S,toggleShowFilters:G}}function ee(a){return a==="\u221E"?Number.POSITIVE_INFINITY:Number(a)}const Le=(0,K.A)(a=>({content:{minHeight:0},container:{height:"100%",maxHeight:"100%",minHeight:0},fullHeight:{maxHeight:"100%",display:"flex",minHeight:0},graphWrapper:{position:"relative",flex:1,minHeight:0,display:"flex"},graph:{flex:1,minHeight:0},legend:{position:"absolute",bottom:0,right:0,padding:a.spacing(1),"& .icon":{verticalAlign:"bottom"}},filters:{display:"grid",gridGap:a.spacing(1),gridAutoRows:"auto",[a.breakpoints.up("lg")]:{display:"block"},[a.breakpoints.only("md")]:{gridTemplateColumns:"repeat(3, 1fr)"},[a.breakpoints.only("sm")]:{gridTemplateColumns:"repeat(2, 1fr)"},[a.breakpoints.down("xs")]:{gridTemplateColumns:"repeat(1, 1fr)"}}}),{name:"PluginCatalogGraphCatalogGraphPage"}),Ke=a=>{const{relationPairs:r=h.A,initialState:t}=a,o=(0,V.Zp)(),i=Le(),u=(0,F.Sf)(C.sF),{maxDepth:m,setMaxDepth:c,selectedKinds:_,setSelectedKinds:d,selectedRelations:s,setSelectedRelations:E,unidirectional:g,setUnidirectional:B,mergeRelations:O,setMergeRelations:U,direction:f,setDirection:H,curve:b,setCurve:S,rootEntityNames:D,setRootEntityNames:G,showFilters:W,toggleShowFilters:y}=Te({initialState:t}),l=(0,F.st)(),M=(0,e.useCallback)((v,x)=>{var k,te;const R=(0,A.KU)(v.id);if(x.shiftKey){const ae=u({kind:R.kind.toLocaleLowerCase("en-US"),namespace:R.namespace.toLocaleLowerCase("en-US"),name:R.name});l.captureEvent("click",(k=v.entity.metadata.title)!=null?k:(0,C.SE)(R),{attributes:{to:ae}}),o(ae)}else l.captureEvent("click",(te=v.entity.metadata.title)!=null?te:(0,C.SE)(R)),G([R])},[u,o,G,l]);return e.createElement(p.YW,{themeId:"home"},e.createElement(p.Y9,{title:"Catalog Graph",subtitle:D.map(v=>(0,C.SE)(v)).join(", ")}),e.createElement(p.UC,{stretch:!0,className:i.content},e.createElement(p.dv,{titleComponent:e.createElement(se.A,{value:"show filters",selected:W,onChange:()=>y()},e.createElement(re.A,null)," Filters")},e.createElement(p.Yl,null,"Start tracking your component in by adding it to the software catalog.")),e.createElement(L.A,{container:!0,alignItems:"stretch",className:i.container},W&&e.createElement(L.A,{item:!0,xs:12,lg:2,className:i.filters},e.createElement(Pe,{value:m,onChange:c}),e.createElement(fe,{value:_,onChange:d}),e.createElement(Re,{value:s,onChange:E,relationPairs:r}),e.createElement(De,{value:f,onChange:H}),e.createElement(Ae,{value:b,onChange:S}),e.createElement(q,{value:g,onChange:B,label:"Simplified"}),e.createElement(q,{value:O,onChange:U,label:"Merge Relations"})),e.createElement(L.A,{item:!0,xs:!0,className:i.fullHeight},e.createElement(le.A,{className:i.graphWrapper},e.createElement(N.A,{variant:"caption",color:"textSecondary",display:"block",className:i.legend},e.createElement(oe.A,{className:"icon"})," Use pinch & zoom to move around the diagram. Click to change active node, shift click to navigate to entity."),e.createElement(h.E,{...a,rootEntityNames:D,maxDepth:m,kinds:_&&_.length>0?_:void 0,relations:s&&s.length>0?s:void 0,mergeRelations:O,unidirectional:g,onNodeClick:M,direction:f,relationPairs:r,className:i.graph,zoom:"enabled",curve:b}))))))}},98984:(ne,I,n)=>{var A,p=n(4293),T=n(78920);A={value:!0},I.A=void 0;var F=T(n(14041)),C=p(n(74044)),L=(0,C.default)(F.createElement("path",{d:"M15 3l2.3 2.3-2.89 2.87 1.42 1.42L18.7 6.7 21 9V3h-6zM3 9l2.3-2.3 2.87 2.89 1.42-1.42L6.7 5.3 9 3H3v6zm6 12l-2.3-2.3 2.89-2.87-1.42-1.42L5.3 17.3 3 15v6h6zm12-6l-2.3 2.3-2.87-2.89-1.42 1.42 2.89 2.87L15 21h6v-6z"}),"ZoomOutMap");I.A=L}}]);})();

//# sourceMappingURL=6605.2f5186a9.chunk.js.map